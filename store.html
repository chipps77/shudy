<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>å•†åº—</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="main-wrapper">
    <div class="idolTextWrapper">
      <div id="idolText">ç”¨ç›¤å­æ›ä½ å–œæ­¡çš„æ±è¥¿ ğŸ½ï¸</div>
    </div>
    <div class="plates">ğŸ½ï¸ ç›®å‰æœ‰ï¼š<span id="plateCount">0</span> ç›¤å­</div>
    <div class="buttons">
      <button onclick="buyItem('bg_flower', 3)">ğŸŒ¼ è£é£¾å“ï¼ˆ3ç›¤å­ï¼‰</button>
      <button onclick="buyItem('cake', 2)">ğŸ° è›‹ç³•ï¼ˆ2ç›¤å­ï¼‰</button>
      <button onclick="buyItem('idol_egg', 5)">ğŸ¥š å¶åƒè›‹ï¼ˆ5ç›¤å­ï¼‰</button>
      <button onclick="buyItem('vege', 1)"> è”¬èœï¼ˆ1ç›¤å­ï¼‰</button>
      <button onclick="buyItem('kimchi_rice', 2)"> æ³¡èœç‚’é£¯ï¼ˆ2ç›¤å­ï¼‰</button>
      <button onclick="buyItem('rice', 1)"> ç™½é£¯ï¼ˆ1ç›¤å­ï¼‰</button>
      <button onclick="goBack()">å›é¦–é </button>
    </div>
  </div>

  <script>
    const quantityItems = ["cake", "vege", "kimchi_rice", "rice"];

    function goBack() {
      localStorage.setItem("fromStore", "true");
      window.location.href = "index.html";
    }

    document.getElementById("plateCount").textContent =
      localStorage.getItem("plates") || "0";

    function buyItem(itemKey, cost) {
      const plates = parseInt(localStorage.getItem("plates") || "0");
      if (plates >= cost) {
        localStorage.setItem("plates", (plates - cost).toString());

        if (quantityItems.includes(itemKey)) {
          const current = parseInt(localStorage.getItem("item_" + itemKey) || "0");
          localStorage.setItem("item_" + itemKey, (current + 1).toString());
        } else {
          localStorage.setItem("item_" + itemKey, "true");
        }
 
if (itemKey === "idol_egg") {
  const roll = Math.random();

  const hasHaku = localStorage.getItem("item_dog_haku") === "true";
  const hasMata = localStorage.getItem("item_dog_mata") === "true";
  const hasMoya = localStorage.getItem("item_dog_moya") === "true";

  function giveCake(count = 1) {
    const current = parseInt(localStorage.getItem("item_cake") || "0");
    localStorage.setItem("item_cake", (current + count).toString());
    alert("ğŸ° ç‹—ç‹—å·²æ“æœ‰ï¼Œæ”¹é€è›‹ç³•ï¼");
  }

  if (roll < 0.3) {
    if (!hasHaku) {
      localStorage.setItem("item_dog_haku", "true");
      alert("ğŸ‰ æŠ½åˆ°äº†ç‹—ç‹— Hakuï¼");
    } else {
      giveCake();
    }
  } else if (roll < 0.6) {
    if (!hasMata) {
      localStorage.setItem("item_dog_mata", "true");
      alert("ğŸ‰ æŠ½åˆ°äº†ç‹—ç‹— Mataï¼");
    } else {
      giveCake();
    }
  } else if (roll < 0.7) {
    if (!hasMoya) {
      localStorage.setItem("item_dog_moya", "true");
      alert("ğŸ‰ æŠ½åˆ°äº†ç‹—ç‹— Moyaï¼");
    } else {
      giveCake();
    }
  } else {
    const current = parseInt(localStorage.getItem("item_rice") || "0");
    localStorage.setItem("item_rice", (current + 3).toString());
    alert("ğŸš æ²’æŠ½åˆ°ç‹—ç‹—ï¼Œæ‹¿åˆ°äº† 3 ç¢—ç™½é£¯");
  }
}





        document.getElementById("plateCount").textContent = localStorage.getItem("plates");
        alert("è³¼è²·æˆåŠŸï¼š" + itemKey);
      } else {
        alert("ä½ çš„ç›¤å­ä¸å¤ å”·ï¼");
      }
    }
  </script>
</body>
</html>
